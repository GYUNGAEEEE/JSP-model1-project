# 04-2. 출력 버퍼와 응답
JSP 페이지는 응답 결과를 곧바로 웹 브라우저에 전송하지 않는다. 
대신 출력 버퍼(buffer)라고 불리는 곳에 임시로 응답 결과를 저장했다가 한 번에 웹 브라우저에 전송한다.
버퍼가 다 차면 JSP 페이지는 버퍼의 내용을 웹 브라우저에 전송한 후 버퍼를 비우고 새롭게 버퍼에 내용을 채우기 시작한다.

![image](https://github.com/GYUNGAEEEE/WebProgramming/assets/158580466/45d94ccb-39f9-427d-bb69-6fa1ed0d0e0f)

버퍼를 사용하면 데이터를 한 번에 큰 단위로 데이터를 전송하는 것이 가능하기 때문에 성능이 향상된다.

버퍼를 사용함으로써 \<jsp:forward> 기능과 에러 페이지 처리 기능이 가능하다.
버퍼에 보관된 데이터는 일정 크기가 될 때까지 웹 브라우저에 전송되지 않는다.
따라서, JSP 페이지가 생성한 내용이 있다 하더라도 
버퍼에 저장된 데이터가 웹 브라우저로 전송되기 전까지는 버퍼에 보관된 데이터를 지우고 새로운 내용을 전송할 수 있다.
예를 들어, 에러가 발생하면, 버퍼의 내용을 지우고 에러 화면을 출력할 수 있다.

버퍼가 다 차기 전에는 헤더 정보를 변경할 수 있다.
HTTP 프로토콜의 구조상 응답 상태 코드와 함께 헤더 정보를 가장 먼저 웹 브라우저에 전송해야 하는데,
WAS는 처음 버퍼의 내용을 웹 브라우저로 전송하기 전에 헤더 정보를 전송한다.
따라서, 첫 번째로 버퍼의 내용을 전송하기 전까지는 헤더 정보를 변경할 수 있다.
***
## page 디렉티브에서 버퍼 설정하기 : buffer 속성과 autoFlush 속성
page 디렉티브의 buffer 속성은 JSP 페이지가 사용할 버퍼의 크기를 지정할 때 사용하며, 킬로바이트 단위로 지정한다.
속성값에 kb를 붙어야 하며, 버퍼를 사용하고 싶지 않다면 "none"으로 지정하면 된다.
```jsp
<%@ page buffer="4kb" %>
<%@ page buffer="none" %>
```
buffer 속성의 값을 "none"으로 지정하면 JSP 페이지가 출력하는 내용을 곧바로 웹 브라우저에 전송하기 때문에, 
다음과 같은 기능을 사용하는 데 제한이 따른다.
- \<jsp:forward> 기능을 사용할 수 없다.
- 곧바로 전송되기 때문에 출력한 내용을 취소할 수 없다.

> 플러시(flush): 버퍼가 다 찼을 때, 버퍼에 쌓인 데이터를 실제로 전송되어야 할 곳(또는 저장되어야 할 곳)에 전송하고(또는 저장하고)
> 버퍼를 비우는 것을 말한다.

page 디렉티브는 autoFlush 속성을 제공한다. 이 속성을 사용하면 버퍼가 다 찼을 때 어떻게 처리할지를 결정할 수 있다.
- true: 버퍼가 다 차면 버퍼를 플러시하고 계속해서 작업을 진행한다.
- false: 버퍼가 다 차면 익셉션을 발생시키고 작업을 중지한다.
```jsp
<%@ page autoFlush="true" %>
<%@ page autoFlush="false" %>
```
